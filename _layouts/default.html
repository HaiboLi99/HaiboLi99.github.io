<!DOCTYPE html>
<html>
  <head>
    <!-- ✅ 1. 优先设置主题，防止闪烁 -->
    <script>
(function () {
  var saved = localStorage.getItem('theme');
  var systemDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
  var theme = saved ? saved : (systemDark ? 'dark' : 'light');

  // 1) 先在 <html> 上应用主题，并临时关闭过渡，避免闪烁
  var html = document.documentElement;
  html.classList.add('no-transitions');
  html.classList.add(theme + '-theme');

  // 2) DOM 就绪后，同步到 <body>，并恢复过渡
  document.addEventListener('DOMContentLoaded', function () {
    document.body.classList.add(theme + '-theme');
    html.classList.remove('no-transitions');
  });
})();
</script>

    {% include head.html %}
  </head>

  <body>
    <!-- ✅ Flexbox 根容器 -->
    <div class="site-wrapper d-flex flex-column min-vh-100">
      <!-- ✅ 页眉 -->
      {% include header.html %}

      <!-- ✅ 主体内容 -->
      <main class="content">
        <div class="container-fluid">
          <div class="row">
            {{ content }}
          </div>
        </div>
      </main>

      <!-- ✅ 页脚 -->
      {% include footer.html %}
    </div>

    <!-- ✅ 2. 主题切换按钮逻辑（支持多个按钮） -->
    <script>
  function updateThemeIcon() {
    const btns = document.querySelectorAll('.theme-toggle-btn');
    const isDark = document.body.classList.contains('dark-theme');
    btns.forEach(btn => btn.textContent = isDark ? '🌙' : '☀️');
  }

  function toggleTheme() {
    const isDark = document.body.classList.contains('dark-theme');
    const toDark = !isDark;

    // 同步切换 html 与 body
    document.documentElement.classList.toggle('dark-theme', toDark);
    document.documentElement.classList.toggle('light-theme', !toDark);
    document.body.classList.toggle('dark-theme', toDark);
    document.body.classList.toggle('light-theme', !toDark);

    localStorage.setItem('theme', toDark ? 'dark' : 'light');
    updateThemeIcon();
  }

  document.addEventListener('DOMContentLoaded', updateThemeIcon);
</script>

  </body>
</html>
