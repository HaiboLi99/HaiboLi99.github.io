<!-- 🚀 一定要放在任何 <link rel="stylesheet"> 之前 -->
<head>
  <script>
    (function () {
      try {
        // 1. 先读 localStorage  
        const saved = localStorage.getItem('theme');
        // 2. 如果没存，则根据系统偏好判断
        const auto = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
        const theme = saved || (auto ? 'light' : 'dark');
        // 3. 直接给 <html> 和 <body> 都加上主题类
        document.documentElement.classList.add(theme + '-theme');
        document.body.classList.add(theme + '-theme');
      } catch (e) {
        document.documentElement.classList.add('dark-theme');
        document.body.classList.add('dark-theme');
      }
    })();
  </script>

  <!-- 下面才是你的常规 head 内容 -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title }} | {{ site.title }}</title>
  <link rel="stylesheet" href="{{ '/assets/css/main.css' | relative_url }}">
  <!-- … 其他 head 标签 … -->
</head>


<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id={{ site.google_tag_manager }}"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


<nav class="navbar sticky-top navbar-expand-md navbar-dark bg-dark">
  <a class="navbar-brand" href="{{ site.url }}{{ site.baseurl }}/">
    <img src="{{ site.url }}{{ site.baseurl }}/favicon.ico" width="40" height="40" style="margin-right:5px" class="d-inline-block align-top" alt="">
    <span style="font-size: 30px;">{{ site.title | escape }}</span>
  </a>
  <button class="toggler navbar-toggler collapsed" type="button" data-bs-toggle="collapse"
    data-bs-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false"
    aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <div class="collapse navbar-collapse" id="navbarColor02">
    <!-- ✅ 左侧导航链接 -->
    <div class="navbar-nav mr-auto">
      <a class="nav-item nav-link" href="{{ site.url }}{{ site.baseurl }}/">Home</a>
      {% for page in site.nav_pages %}
        <a class="nav-item nav-link" href="{{ site.url }}{{ site.baseurl }}/{{page.name}}">{{page.name | capitalize }}</a>
      {% endfor %}
    </div>

    <!-- ✅ 右侧切换按钮 -->
    <div class="navbar-nav ml-auto">
        <button id="theme-toggle-btn" class="theme-toggle-btn" onclick="toggleTheme()">🌙</button>
    </div>
  </div>
</nav>


<style>
  .theme-toggle-btn {
    border: none !important;
    background: transparent !important;
    font-size: 1.3em;
    padding: 4px 10px;
    cursor: pointer;
    color: inherit;
    transition: transform 0.2s ease;
  }

  .theme-toggle-btn:hover {
    transform: scale(1.15);
    text-shadow: 0 0 1px rgba(0, 0, 0, 0.2);
  }
</style>

